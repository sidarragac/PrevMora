# SonarQube/SonarCloud configuration for PrevMora project
# Configuration for comprehensive code quality analysis

# === PROJECT INFORMATION ===
sonar.projectKey=prevmora_microfinance
sonar.projectName=PrevMora - Microfinance Credit Management
sonar.projectVersion=1.0.0
sonar.organization=eafit-university

# === SOURCE CODE SETTINGS ===
sonar.sources=backend/credit_management/app,frontend/src
sonar.tests=backend/credit_management/tests,frontend/__tests__

# === LANGUAGE-SPECIFIC SETTINGS ===

# Python settings
sonar.python.coverage.reportPaths=backend/credit_management/coverage.xml
sonar.python.xunit.reportPath=backend/credit_management/test-results.xml
sonar.python.bandit.reportPaths=backend/credit_management/bandit-report.json
sonar.python.pylint.reportPaths=backend/credit_management/pylint-report.txt

# TypeScript/JavaScript settings
sonar.typescript.lcov.reportPaths=frontend/coverage/lcov.info
sonar.javascript.lcov.reportPaths=frontend/coverage/lcov.info
sonar.eslint.reportPaths=frontend/eslint-report.json

# === EXCLUSIONS ===
sonar.exclusions=**/*_test.py,**/*test*.py,**/tests/**,**/node_modules/**,**/venv/**,**/__pycache__/**,**/migrations/**,**/*.pyc,**/.next/**,**/build/**,**/dist/**,**/*.min.js,**/*.bundle.js

# Test exclusions
sonar.test.exclusions=**/tests/**,**/*.test.ts,**/*.test.tsx,**/*.spec.ts,**/*.spec.tsx

# Coverage exclusions
sonar.coverage.exclusions=**/tests/**,**/*_test.py,**/*test*.py,**/conftest.py,**/__init__.py,**/migrations/**,**/*.test.ts,**/*.test.tsx,**/*.spec.ts,**/*.spec.tsx

# === QUALITY GATE SETTINGS ===
sonar.qualitygate.wait=true

# === DUPLICATIONS ===
sonar.cpd.exclusions=**/migrations/**,**/tests/**

# === TECHNICAL DEBT ===
# Set higher maintainability rating requirements
sonar.technical_debt.rating_grid=0.05,0.1,0.2,0.5

# === CODE SMELLS ===
# Enforce stricter code smell detection
sonar.maintainability.rating=A

# === SECURITY ===
# Enforce security vulnerability detection
sonar.security.rating=A

# === RELIABILITY ===
# Enforce bug detection
sonar.reliability.rating=A

# === CUSTOM RULES ===

# Python custom rules
sonar.python.pylint=/usr/local/bin/pylint
sonar.python.bandit=/usr/local/bin/bandit

# === ANALYSIS PARAMETERS ===
sonar.analysis.mode=publish
sonar.buildbreaker.skip=false

# === BRANCH ANALYSIS ===
# Automatically analyze pull requests
sonar.pullrequest.provider=github
sonar.pullrequest.github.repository=prevmora/project

# === NEW CODE DEFINITION ===
# Define what constitutes "new code" for quality gate
sonar.newCode.referenceBranch=main

# === SIZE METRICS ===
# File and method size limits
sonar.size.functions=30
sonar.size.files=500

# === COMPLEXITY METRICS ===
# Cyclomatic complexity limits
sonar.complexity.functions=10
sonar.complexity.file=50

# === DOCUMENTATION ===
# Public API documentation requirements
sonar.coverage.jacoco.xmlReportPaths=backend/credit_management/coverage.xml
sonar.python.coverage.reportPaths=backend/credit_management/coverage.xml

# === NAMING CONVENTIONS ===
# Enforce naming standards through custom rules
sonar.python.naming.class.format=^[A-Z][a-zA-Z0-9]*$
sonar.python.naming.method.format=^[a-z_][a-z0-9_]*$
sonar.python.naming.variable.format=^[a-z_][a-z0-9_]*$
sonar.python.naming.constant.format=^[A-Z_][A-Z0-9_]*$

# === ISSUE SEVERITY ===
# Set custom severity levels for different rule types
sonar.issue.ignore.multicriteria=e1,e2,e3,e4

# Ignore certain rules in test files
sonar.issue.ignore.multicriteria.e1.ruleKey=python:S1192
sonar.issue.ignore.multicriteria.e1.resourceKey=**/tests/**

# Ignore line length in generated files
sonar.issue.ignore.multicriteria.e2.ruleKey=python:S103
sonar.issue.ignore.multicriteria.e2.resourceKey=**/migrations/**

# Ignore complexity in models
sonar.issue.ignore.multicriteria.e3.ruleKey=python:S1067
sonar.issue.ignore.multicriteria.e3.resourceKey=**/models/**

# Ignore certain TypeScript rules in config files
sonar.issue.ignore.multicriteria.e4.ruleKey=typescript:S1128
sonar.issue.ignore.multicriteria.e4.resourceKey=**/*.config.*

# === INCREMENTAL ANALYSIS ===
# Enable incremental analysis for faster feedback
sonar.scm.provider=git
sonar.scm.forceReloadAll=false
